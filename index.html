<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IA Gemini</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                },
            },
        };
    </script>
    
    <style>
        #chat-area::-webkit-scrollbar {
            width: 8px;
        }
        #chat-area::-webkit-scrollbar-track {
            background: #1e1e1e;
        }
        #chat-area::-webkit-scrollbar-thumb {
            background-color: #7c3aed; /* roxo */
            border-radius: 20px;
        }
        body, html {
            height: 100%;
        }
    </style>
</head>

<body class="bg-black text-gray-200 font-sans flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-2xl bg-[#0d0d0f] rounded-xl shadow-2xl flex flex-col overflow-hidden border border-gray-700" style="height: 85vh;">

        <!-- CABEÇALHO ROXO -->
        <header class="p-4 border-b border-gray-800 flex items-center justify-center gap-3 
                       bg-gradient-to-r from-purple-600 via-purple-700 to-purple-900 text-white">
            
            

            <h1 class="text-xl font-bold">Gemini</h1>
        </header>

        <div id="chat-area" class="flex-1 p-4 space-y-4 overflow-y-auto flex flex-col">
            <div class="flex justify-start">
                <div class="bg-gray-900 border border-purple-600 text-purple-200 p-3 rounded-lg max-w-xs md:max-w-md shadow">
                    <p>Olá! Pergunte-me qualquer coisa sobre o mundo!</p>
                </div>
            </div>
        </div>

        <div id="loading-indicator" class="p-4 text-center text-sm text-gray-400 hidden">
            <p>Digitando...</p>
        </div>

        <form id="chat-form" class="p-4 border-t border-gray-800 bg-black">
            <div class="flex gap-3">
                <input 
                    type="text" 
                    id="message-input"
                    placeholder="Qual é a pessoa mais rica do mundo?" 
                    class="flex-1 bg-gray-900 border border-gray-600 rounded-lg p-3 text-gray-200 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-purple-500"
                    autocomplete="off"
                >
                <button 
                    type="submit" 
                    id="send-button"
                    class="bg-gradient-to-r from-purple-600 via-purple-700 to-purple-900 text-white font-semibold p-3 rounded-lg hover:opacity-90 transition-colors disabled:bg-gray-700 disabled:cursor-not-allowed flex items-center justify-center w-24"
                >
                    Perguntar
                </button>
            </div>
        </form>

        <footer class="p-2 text-center bg-gradient-to-r from-purple-600 via-purple-700 to-purple-900 text-white">
            <p class="text-xs opacity-90">IA por Lucas de Souza</p>
        </footer>

    </div>

    <script>
        const chatForm = document.getElementById('chat-form');
        const messageInput = document.getElementById('message-input');
        const sendButton = document.getElementById('send-button');
        const chatArea = document.getElementById('chat-area');
        const loadingIndicator = document.getElementById('loading-indicator');
        const apiKey = "AIzaSyAMG9MUaZmvZF3Cgy1tFsd6WAsugLKfDZY";
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
        const systemPrompt = "Você é um assistente virtual. Responda curto e sempre termine com: 'deseja mais detalhes?'";

        function addMessageToChat(sender, text) {
            const messageDiv = document.createElement('div');
            messageDiv.classList.add('flex');

            const messageBubble = document.createElement('div');
            messageBubble.classList.add('p-3', 'rounded-lg', 'max-w-xs', 'md:max-w-md', 'shadow');
            messageBubble.textContent = text;

            if (sender === 'user') {
                // BOLHA DO USUÁRIO (ROXO)
                messageDiv.classList.add('justify-end');
                messageBubble.classList.add('bg-purple-600', 'text-white', 'border', 'border-purple-400');
            } else {
                // BOLHA DA IA (CINZA COM ROXO)
                messageDiv.classList.add('justify-start');
                messageBubble.classList.add('bg-gray-900', 'text-purple-200', 'border', 'border-purple-600');
            }

            messageDiv.appendChild(messageBubble);
            chatArea.appendChild(messageDiv);
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        function setFormDisabled(disabled) {
            messageInput.disabled = disabled;
            sendButton.disabled = disabled;
            loadingIndicator.classList.toggle('hidden', !disabled);
        }

        async function handleFormSubmit(event) {
            event.preventDefault();

            const userQuery = messageInput.value.trim();
            if (!userQuery) return;

            addMessageToChat('user', userQuery);
            messageInput.value = '';
            setFormDisabled(true);

            try {
                const payload = {
                    contents: [{ parts: [{ text: userQuery }] }],
                    systemInstruction: { parts: [{ text: systemPrompt }] }
                };

                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                const result = await response.json();
                const aiResponse = result.candidates?.[0]?.content?.parts?.[0]?.text;

                addMessageToChat('ia', aiResponse || 'Não encontrei uma resposta.');
            } catch (error) {
                addMessageToChat('ia', `Erro: ${error.message}`);
            } finally {
                setFormDisabled(false);
                messageInput.focus();
            }
        }

        chatForm.addEventListener('submit', handleFormSubmit);
        window.onload = () => messageInput.focus();
    </script>

</body>
</html>
